<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Яндекс Карта v3</title>
    <script src="https://api-maps.yandex.ru/v3/?apikey=ef711d81-f625-4b3c-9d56-bfac2d9dd499&lang=ru_RU"></script>
    <script>
        async function initMap() {
            await ymaps3.ready;

            // Подключаем дополнительные модули
            ymaps3.import.registerCdn('https://cdn.jsdelivr.net/npm/{package}', '@yandex/ymaps3-default-ui-theme@0.0');

            const { YMap, YMapDefaultSchemeLayer, YMapDefaultFeaturesLayer } = ymaps3;
            const { YMapDefaultMarker } = await ymaps3.import('@yandex/ymaps3-default-ui-theme');

            // Загружаем настройки кастомизации
            let customization = null;
            try {
                const response = await fetch('customization.json');
                if (response.ok) {
                    customization = await response.json();
                } else {
                    console.warn('Не удалось загрузить customization.json');
                }
            } catch (error) {
                console.error('Ошибка загрузки customization.json:', error);
            }

            // Создаём карту
            const map = new YMap(document.getElementById('map'), {
                location: { center: [0, 0], zoom: 2 }
            });

            // Добавляем слои карты
            map.addChild(new YMapDefaultSchemeLayer(customization ? { customization } : {}));
            map.addChild(new YMapDefaultFeaturesLayer()); // <-- ДОБАВЛЕН ФИКС!

            // Добавляем метки
            const markers = [
                { coordinates: [-60.3, -10.5], title: 'South America', subtitle: 'Has the longest mountain range', color: 'red' },
                { coordinates: [88.5, 50.6], title: 'Asia', subtitle: 'Has the highest mountain', color: 'green' }
            ];

            markers.forEach(markerData => {
                const marker = new YMapDefaultMarker({
                    coordinates: markerData.coordinates,
                    title: markerData.title,
                    subtitle: markerData.subtitle,
                    color: markerData.color,
                    size: 'normal'
                });
                map.addChild(marker);
            });
        }
    </script>
</head>
<body onload="initMap()">
    <div id="map" style="width: 100vw; height: 100vh;"></div>
</body>
</html>
